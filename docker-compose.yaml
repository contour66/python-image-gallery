---
version: "3"

services:
  database:
    image: "postgres:11"
    environment:
      PG_PASSWORD: "xF8l6v0CxwI"
      PG_USER: postgres
      PG_DATABASE: postgres
      PG_DATA: /var/lib/postgresql/data/pgdata
    deploy:
      mode: "replicated"
      replicas: 1
      placement:
        constraints:
          - node.labels.postgres_server==yes
    volumes:
      - "/mnt/efs/postgres-data:/var/lib/postgresql/data"
