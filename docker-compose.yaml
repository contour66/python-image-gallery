---
version: "3"

services:

#  registry:
#    image: registry:latest
#    ports:
#      -"5000:5000"
#    deploy:
#      replicas: 1
#      placement:
#        constraint:
#          - node.role==manager
#    environment:
#      REGISTERY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /mnt/registry
#    volumes:
#      -"registery:/mnt/gallery"
  database:
    image: "postgres:11"
    environment:
      POSTGRES_PASSWORD: "xF8l6v0CxwI"
      POSTGRES_USER: postgres
      POSTGRES_DATABASE: postgres
      PGDATA: /var/lib/postgresql/data/pgdata
    deploy:
      mode: "replicated"
      replicas: 1
      placement:
        constraints:
          - node.labels.postgres_server==yes
    volumes:
      - "/mnt/efs/postgres-data:/var/lib/postgresql/data"

volumes:
  database:
      external: true